<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recetario Delicioso</title>

    <!-- Metadatos para PWA -->
    <meta name="theme-color" content="#78350f"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Recetario">
    <link rel="apple-touch-icon" href="https://placehold.co/192x192/78350f/ffffff?text=R">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/manifest+json,{
        &quot;name&quot;: &quot;Recetario Delicioso&quot;,
        &quot;short_name&quot;: &quot;Recetario&quot;,
        &quot;start_url&quot;: &quot;.&quot;,
        &quot;display&quot;: &quot;standalone&quot;,
        &quot;background_color&quot;: &quot;#f8f7f5&quot;,
        &quot;theme_color&quot;: &quot;#78350f&quot;,
        &quot;description&quot;: &quot;Tu app de recetas de cocina española.&quot;,
        &quot;icons&quot;: [{
            &quot;src&quot;: &quot;https://placehold.co/192x192/78350f/ffffff?text=R&quot;,
            &quot;sizes&quot;: &quot;192x192&quot;,
            &quot;type&quot;: &quot;image/png&quot;
        }, {
            &quot;src&quot;: &quot;https://placehold.co/512x512/78350f/ffffff?text=R&quot;,
            &quot;sizes&quot;: &quot;512x512&quot;,
            &quot;type&quot;: &quot;image/png&quot;
        }]
    }">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Configuración para el modo oscuro de Tailwind
        tailwind.config = {
            darkMode: 'class',
        }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Lora:wght@500;700&display=swap" rel="stylesheet">

    <!-- Estilos personalizados -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f7f5;
        }
        .dark body {
            background-color: #1c1917; /* stone-900 */
        }
        h1, h2, h3, h4 {
            font-family: 'Lora', serif;
        }
        .category-btn.active, .filter-btn.active {
            background-color: #78350f; /* amber-900 */
            color: white;
            font-weight: 600;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        }
        .dark .category-btn.active, .dark .filter-btn.active {
            background-color: #f59e0b; /* amber-500 */
            color: #1c1917;
        }
        .category-btn, .filter-btn {
            transition: all 0.2s ease-in-out;
        }
        /* Estilos de Impresión */
        @media print {
            body * {
                visibility: hidden;
            }
            #recipeModal, #recipeModal * {
                visibility: visible;
            }
            #recipeModal {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: auto;
                background: none;
            }
            #modalContent {
                box-shadow: none;
                border: none;
                max-width: 100%;
                max-h: none;
                overflow-y: visible;
                background-color: white !important;
                color: black !important;
            }
            #closeModalBtn, .modal-buttons-container {
                display: none !important;
            }
            .dark #modalContent, .dark #modalContent * {
                background-color: white !important;
                color: black !important;
            }
            h2, h4 {
                color: black !important;
            }
            ul, ol {
                color: #333 !important;
            }
            img {
                -webkit-print-color-adjust: exact; 
                print-color-adjust: exact;
            }
        }
    </style>
</head>
<body class="dark:bg-stone-900 dark:text-stone-200">

    <div id="app" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- Cabecera -->
        <header class="relative text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-amber-900 dark:text-amber-500">Recetario Delicioso</h1>
            <p class="text-gray-600 dark:text-stone-400 mt-2">80 recetas para inspirar tu cocina.</p>
            <div id="user-info" class="text-xs text-gray-400 mt-2"></div>
            
            <!-- Interruptor Modo Oscuro -->
            <div class="absolute top-0 right-0">
                <button id="theme-toggle" class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-stone-700 focus:outline-none">
                    <svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                    <svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 5.05A1 1 0 003.636 6.464l.707.707a1 1 0 101.414-1.414l-.707-.707zM3 11a1 1 0 100-2H2a1 1 0 100 2h1zM6.464 16.364l-.707.707a1 1 0 001.414 1.414l.707-.707a1 1 0 00-1.414-1.414zM13.536 16.364a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414l.707.707z"></path></svg>
                </button>
            </div>
        </header>
        
        <!-- Controles -->
        <div class="sticky top-4 bg-f8f7f5/90 dark:bg-stone-900/90 backdrop-blur-sm z-10 py-4 rounded-xl shadow-sm">
            <div class="flex flex-col sm:flex-row gap-4 mb-4 px-4">
                <div class="relative flex-grow">
                    <input type="text" id="searchInput" placeholder="Buscar por nombre o ingrediente..." class="w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-stone-600 rounded-full focus:outline-none focus:ring-2 focus:ring-amber-500 bg-white dark:bg-stone-800">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                </div>
                <div class="flex items-center justify-center shrink-0 gap-2 bg-amber-100 dark:bg-stone-800 p-1 rounded-full">
                    <button id="filterAll" class="filter-btn px-4 py-2 rounded-full text-sm font-medium">Todas</button>
                    <button id="filterFavorites" class="filter-btn px-4 py-2 rounded-full text-sm font-medium">Favoritas</button>
                </div>
            </div>
            <div id="categoryFilters" class="flex flex-wrap items-center justify-center gap-2 bg-amber-50 dark:bg-stone-800 p-2 rounded-full mx-4">
                <button data-category="all" class="category-btn active px-3 py-1.5 rounded-full text-sm">Todos</button>
                <button data-category="Aperitivo" class="category-btn px-3 py-1.5 rounded-full text-sm">Aperitivos</button>
                <button data-category="Primero" class="category-btn px-3 py-1.5 rounded-full text-sm">Primeros</button>
                <button data-category="Segundo" class="category-btn px-3 py-1.5 rounded-full text-sm">Segundos</button>
                <button data-category="Postre" class="category-btn px-3 py-1.5 rounded-full text-sm">Postres</button>
            </div>
        </div>

        <div id="no-results" class="hidden text-center py-12">
            <p class="text-gray-600 dark:text-stone-400">No se encontraron recetas. ¡Intenta otra búsqueda o filtro!</p>
        </div>

        <!-- Cuadrícula de Recetas -->
        <div id="recipeGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mt-8">
            <!-- Las recetas se insertan aquí -->
        </div>
    </div>

    <!-- Modal -->
    <div id="recipeModal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center z-50 p-4">
        <div id="modalContent" class="bg-white dark:bg-stone-800 rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto transform scale-95 transition-transform duration-300"></div>
    </div>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        function runRecipeApp() {
            const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : { apiKey: "DEMO_KEY", authDomain: "DEMO.firebaseapp.com", projectId: "DEMO_PROJECT" };
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'recetario-delicioso-final';

            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);
            const auth = getAuth(app);

            let userFavorites = [], userId = null;
            let currentFilter = 'all', currentCategory = 'all';

            const dom = {
                grid: document.getElementById('recipeGrid'),
                search: document.getElementById('searchInput'),
                filterAllBtn: document.getElementById('filterAll'),
                filterFavBtn: document.getElementById('filterFavorites'),
                categoryFilters: document.getElementById('categoryFilters'),
                noResults: document.getElementById('no-results'),
                modal: document.getElementById('recipeModal'),
                modalContent: document.getElementById('modalContent'),
                userInfo: document.getElementById('user-info'),
                themeToggle: document.getElementById('theme-toggle'),
                darkIcon: document.getElementById('theme-toggle-dark-icon'),
                lightIcon: document.getElementById('theme-toggle-light-icon'),
            };
            
            const allRecipes = [
                // 20 Aperitivos
                { id: "patatas-bravas", name: "Patatas Bravas", category: "Aperitivo", time: "30 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1599921867822-6b3a0f0a5fee?q=80&w=800", ingredients: [{amount: 1, unit: 'kg', name: 'de patatas'}, {amount: null, unit: '', name: 'Aceite de oliva'}, {amount: null, unit: '', name: 'Salsa brava'}, {amount: null, unit: '', name: 'Alioli'}], steps: ["Pela y corta las patatas en cubos irregulares.", "Fríelas en abundante aceite hasta que estén doradas y tiernas.", "Sírvelas calientes con salsa brava y alioli por encima."] },
                { id: "gambas-al-ajillo", name: "Gambas al Ajillo", category: "Aperitivo", time: "10 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1639537339294-35e2193b134a?q=80&w=800", ingredients: [{amount: 250, unit: 'g', name: 'de gambas peladas'}, {amount: 4, unit: '', name: 'dientes de ajo'}, {amount: 1, unit: '', name: 'guindilla'}, {amount: null, unit: '', name: 'Aceite de oliva virgen extra'}, {amount: null, unit: '', name: 'Sal'}, {amount: null, unit: '', name: 'Perejil'}], steps: ["Lamina los ajos y sofríelos con la guindilla en una cazuela de barro.", "Cuando los ajos empiecen a dorarse, añade las gambas y una pizca de sal.", "Saltea un par de minutos hasta que las gambas estén hechas.", "Espolvorea perejil picado y sirve inmediatamente."] },
                { id: "gildas", name: "Gildas", category: "Aperitivo", time: "5 min", servings: 12, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Gildas", ingredients: [{amount: 12, unit: '', name: 'anchoas en salazón'}, {amount: 12, unit: '', name: 'aceitunas verdes sin hueso'}, {amount: 12, unit: '', name: 'guindillas en vinagre (piparras)'}], steps: ["Ensarta en un palillo una aceituna, una guindilla doblada por la mitad y una anchoa."] },
                { id: "mejillones-vinagreta", name: "Mejillones a la Vinagreta", category: "Aperitivo", time: "20 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1605494220434-a15d08a5d326?q=80&w=800", ingredients: [{amount: 1, unit: 'kg', name: 'de mejillones'}, {amount: 1, unit: '', name: 'cebolleta'}, {amount: 0.5, unit: '', name: 'pimiento verde'}, {amount: 0.5, unit: '', name: 'pimiento rojo'}, {amount: null, unit: '', name: 'Vinagre de vino blanco'}, {amount: null, unit: '', name: 'Aceite de oliva'}, {amount: null, unit: '', name: 'Sal'}], steps: ["Abre los mejillones al vapor y quédate con la concha que tiene el mejillón.", "Pica las verduras muy finas y mézclalas en un bol.", "Aliña las verduras con aceite, vinagre y sal para hacer la vinagreta.", "Cubre cada mejillón con una cucharada de vinagreta."] },
                { id: "champinones-al-ajillo", name: "Champiñones al Ajillo", category: "Aperitivo", time: "15 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1559160582-e9845523246f?q=80&w=800", ingredients: [{amount: 500, unit: 'g', name: 'de champiñones'}, {amount: 4, unit: '', name: 'dientes de ajo'}, {amount: 50, unit: 'g', name: 'de jamón serrano en tacos (opcional)'}, {amount: 50, unit: 'ml', name: 'de vino blanco'}, {amount: null, unit: '', name: 'Perejil picado'}, {amount: null, unit: '', name: 'Aceite de oliva'}], steps: ["Limpia y lamina los champiñones.", "Dora los ajos laminados en una sartén. Añade el jamón si lo usas.", "Incorpora los champiñones y saltea a fuego fuerte.", "Añade un chorrito de vino blanco y deja que evapore.", "Espolvorea perejil y sirve."] },
                { id: "boquerones-en-vinagre", name: "Boquerones en Vinagre", category: "Aperitivo", time: "15 min + marinado", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Boquerones", ingredients: [{amount: 500, unit: 'g', name: 'de boquerones frescos'}, {amount: 200, unit: 'ml', name: 'de vinagre de vino blanco'}, {amount: 3, unit: '', name: 'dientes de ajo'}, {amount: null, unit: '', name: 'Perejil'}, {amount: 50, unit: 'ml', name: 'de aceite de oliva'}], steps: ["Limpia los boquerones quitando cabeza, espina y tripas. Congélalos 48h para evitar anisakis.", "Descongela y sumérgelos en agua fría con sal.", "Cúbrelos con vinagre y déjalos marinar en la nevera hasta que estén blancos (unas 8 horas).", "Escúrrelos bien y alíñalos con ajo picado, perejil y aceite de oliva."] },
                { id: "pimientos-de-padron", name: "Pimientos de Padrón", category: "Aperitivo", time: "10 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1628129334038-a281864f1d64?q=80&w=800", ingredients: [{amount: 300, unit: 'g', name: 'de pimientos de Padrón'}, {amount: null, unit: '', name: 'Aceite de oliva'}, {amount: null, unit: '', name: 'Sal gorda'}], steps: ["Lava y seca bien los pimientos.", "Fríelos en una sartén con aceite caliente, removiendo hasta que la piel se arrugue.", "Sácalos, escúrrelos y sírvelos con abundante sal gorda por encima."] },
                { id: "pan-con-tomate", name: "Pan con Tomate y Jamón", category: "Aperitivo", time: "5 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1588167040822-913045b74092?q=80&w=800", ingredients: [{amount: 4, unit: 'rebanadas', name: 'de pan de payés'}, {amount: 2, unit: '', name: 'tomates maduros de rama'}, {amount: 1, unit: '', name: 'diente de ajo (opcional)'}, {amount: null, unit: '', name: 'Aceite de oliva virgen extra'}, {amount: 100, unit: 'g', name: 'de jamón serrano'}], steps: ["Tuesta las rebanadas de pan.", "Si te gusta, frota un diente de ajo en el pan tostado.", "Parte un tomate por la mitad y frótalo sobre el pan hasta que quede bien impregnado.", "Añade un chorro de aceite de oliva y coloca una loncha de jamón encima."] },
                { id: "croquetas-de-jamon", name: "Croquetas de Jamón", category: "Aperitivo", time: "40 min + reposo", servings: 6, difficulty: "Medio", image: "https://images.unsplash.com/photo-1619861183287-353f2a8a1599?q=80&w=800", ingredients: [{amount: 100, unit: 'g', name: 'de jamón serrano'}, {amount: 1, unit: 'litro', name: 'de leche'}, {amount: 100, unit: 'g', name: 'de mantequilla'}, {amount: 100, unit: 'g', name: 'de harina'}, {amount: null, unit: '', name: 'Nuez moscada'}, {amount: null, unit: '', name: 'Sal'}, {amount: 2, unit: '', name: 'huevos para rebozar'}, {amount: null, unit: '', name: 'Pan rallado'}], steps: ["Pica el jamón muy fino. Sofríelo un poco en la mantequilla.", "Añade la harina y tuéstala para hacer un roux.", "Vierte la leche poco a poco sin dejar de remover para hacer la bechamel.", "Añade sal y nuez moscada. Cocina hasta que espese.", "Deja enfriar la masa en la nevera (mínimo 4 horas).", "Forma las croquetas, pásalas por huevo y pan rallado, y fríelas en aceite caliente."] },
                { id: "queso-manchego-membrillo", name: "Queso Manchego con Membrillo", category: "Aperitivo", time: "5 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Queso", ingredients: [{amount: 200, unit: 'g', name: 'de Queso Manchego curado'}, {amount: 150, unit: 'g', name: 'de dulce de membrillo'}], steps: ["Corta el queso en cuñas o triángulos.", "Corta el membrillo en lonchas finas.", "Sirve una loncha de membrillo sobre cada trozo de queso."] },
                { id: "zamburinas-plancha", name: "Zamburiñas a la Plancha", category: "Aperitivo", time: "10 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Zamburiñas", ingredients: [{amount: 12, unit: '', name: 'zamburiñas'}, {amount: 2, unit: '', name: 'dientes de ajo'}, {amount: null, unit: '', name: 'Perejil fresco'}, {amount: null, unit: '', name: 'Aceite de oliva virgen extra'}, {amount: null, unit: '', name: 'Sal'}], steps: ["Limpia bien las zamburiñas.", "Pica finamente el ajo y el perejil y mézclalo con un buen chorro de aceite.", "Calienta una plancha o sartén a fuego fuerte.", "Cocina las zamburiñas 1-2 minutos por cada lado.", "Sírvelas inmediatamente con el aliño de ajo y perejil por encima."] },
                { id: "tigres", name: "Tigres (Mejillones Rellenos)", category: "Aperitivo", time: "45 min", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Tigres", ingredients: [{amount: 1, unit: 'kg', name: 'de mejillones'}, {amount: 1, unit: '', name: 'cebolla'}, {amount: 50, unit: 'g', name: 'de mantequilla'}, {amount: 50, unit: 'g', name: 'de harina'}, {amount: 250, unit: 'ml', name: 'de leche'}, {amount: 2, unit: '', name: 'huevos y pan rallado para rebozar'}, {amount: null, unit: '', name: 'Pizca de cayena'}], steps: ["Abre los mejillones al vapor, pica la carne y reserva las conchas.", "Pocha la cebolla en mantequilla. Añade la harina y luego la leche para hacer una bechamel.", "Añade el mejillón picado y la cayena. Rellena las conchas.", "Deja enfriar, pasa por huevo y pan rallado y fríe."] },
                { id: "pimientos-rellenos-piquillo", name: "Pimientos del Piquillo Rellenos", category: "Aperitivo", time: "35 min", servings: 4, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Pimientos", ingredients: [{amount: 1, unit: 'lata', name: 'de pimientos del piquillo'}, {amount: 2, unit: 'latas', name: 'de atún'}, {amount: 0.5, unit: '', name: 'cebolla'}, {amount: 100, unit: 'ml', name: 'de salsa de tomate'}, {amount: 1, unit: '', name: 'huevo duro'}], steps: ["Pocha la cebolla. Mezcla con el atún desmigado y el huevo duro picado.", "Añade un poco de salsa de tomate a la mezcla.", "Rellena los pimientos con cuidado.", "Sírvelos con más salsa de tomate por encima."] },
                { id: "ensalada-campera", name: "Ensalada Campera", category: "Aperitivo", time: "30 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Ensalada+Campera", ingredients: [{amount: 4, unit: '', name: 'patatas cocidas'}, {amount: 2, unit: '', name: 'huevos duros'}, {amount: 1, unit: 'lata', name: 'de atún'}, {amount: 1, unit: '', name: 'cebolleta'}, {amount: 1, unit: '', name: 'pimiento verde'}, {amount: 1, unit: '', name: 'tomate'}, {amount: null, unit: '', name: 'Aceitunas'}], steps: ["Corta las patatas y huevos en trozos.", "Pica la cebolleta, pimiento y tomate.", "Mezcla todos los ingredientes en un bol con el atún y las aceitunas.", "Aliña con aceite de oliva, vinagre y sal."] },
                { id: "pulpo-a-la-gallega", name: "Pulpo a la Gallega", category: "Aperitivo", time: "20 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1672322437950-e8837775973a?q=80&w=800", ingredients: [{amount: 1, unit: '', name: 'pulpo cocido'}, {amount: 2, unit: '', name: 'patatas cocidas'}, {amount: null, unit: '', name: 'Pimentón dulce y picante'}, {amount: null, unit: '', name: 'Sal gorda'}, {amount: null, unit: '', name: 'Aceite de oliva'}], steps: ["Corta el pulpo en rodajas con tijeras.", "Corta las patatas en rodajas y colócalas como base.", "Pon el pulpo sobre las patatas.", "Aliña con sal gorda, los dos pimentones y un buen chorro de aceite."] },
                { id: "chorizo-a-la-sidra", name: "Chorizo a la Sidra", category: "Aperitivo", time: "25 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Chorizo+a+la+Sidra", ingredients: [{amount: 4, unit: '', name: 'chorizos frescos'}, {amount: 1, unit: 'botella', name: 'de sidra natural'}, {amount: 1, unit: '', name: 'hoja de laurel'}], steps: ["Pincha los chorizos con un tenedor.", "Ponlos en una cazuela con el laurel y cúbrelos con sidra.", "Cuece a fuego medio durante 20-25 minutos hasta que la sidra reduzca.", "Sirve el chorizo cortado en rodajas con la salsa."] },
                { id: "morcilla-de-burgos", name: "Morcilla de Burgos Frita", category: "Aperitivo", time: "15 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Morcilla", ingredients: [{amount: 1, unit: '', name: 'morcilla de Burgos'}, {amount: null, unit: '', name: 'Pimientos del piquillo (opcional)'}, {amount: null, unit: '', name: 'Aceite de oliva'}], steps: ["Corta la morcilla en rodajas de 1-2 cm de grosor.", "Pásalas ligeramente por harina (opcional).", "Fríelas en una sartén con poco aceite, vuelta y vuelta, hasta que estén crujientes.", "Sirve caliente, acompañada de pimientos del piquillo."] },
                { id: "setas-al-ajillo", name: "Setas al Ajillo", category: "Aperitivo", time: "15 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Setas+al+Ajillo", ingredients: [{amount: 400, unit: 'g', name: 'de setas de temporada'}, {amount: 3, unit: '', name: 'dientes de ajo'}, {amount: null, unit: '', name: 'Perejil'}, {amount: null, unit: '', name: 'Guindilla (opcional)'}, {amount: 50, unit: 'ml', name: 'de vino blanco'}], steps: ["Limpia y trocea las setas.", "Dora los ajos laminados y la guindilla en una sartén.", "Añade las setas y saltea a fuego fuerte.", "Cuando suelten el agua, añade un chorro de vino y deja que reduzca.", "Espolvorea con perejil picado."] },
                { id: "empanadillas-de-atun", name: "Empanadillas de Atún", category: "Aperitivo", time: "30 min", servings: 16, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Empanadillas", ingredients: [{amount: 1, unit: 'paquete', name: 'de obleas para empanadillas'}, {amount: 2, unit: 'latas', name: 'de atún'}, {amount: 0.5, unit: '', name: 'cebolla pochada'}, {amount: 1, unit: '', name: 'huevo duro picado'}, {amount: 3, unit: 'cucharadas', name: 'de salsa de tomate'}, {amount: 1, unit: '', name: 'huevo para pintar'}], steps: ["Mezcla el atún escurrido con la cebolla, el huevo duro y salsa de tomate.", "Rellena cada oblea con una cucharada de la mezcla.", "Cierra las empanadillas sellando los bordes con un tenedor.", "Píntalas con huevo batido y hornea a 180°C hasta que estén doradas, o fríelas."] },
                { id: "montadito-de-pringa", name: "Montadito de Pringá", category: "Aperitivo", time: "10 min", servings: 6, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Pringá", ingredients: [{amount: 200, unit: 'g', name: 'de pringá del cocido (chorizo, morcilla, carne)'}, {amount: 6, unit: '', name: 'panecillos pequeños'}], steps: ["Desmenuza y mezcla todos los ingredientes de la pringá.", "Calienta la mezcla en una sartén.", "Tuesta los panecillos abiertos.", "Rellena los panecillos generosamente con la pringá caliente."] },
                // 20 Primeros
                { id: "gazpacho-andaluz", name: "Gazpacho Andaluz", category: "Primero", time: "15 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1625944228743-9281a173a113?q=80&w=800", ingredients: [{amount: 1, unit: 'kg', name: 'de tomates maduros'}, {amount: 1, unit: '', name: 'pimiento verde'}, {amount: 1, unit: '', name: 'pepino'}, {amount: 1, unit: '', name: 'diente de ajo'}, {amount: 50, unit: 'g', name: 'de pan'}, {amount: 100, unit: 'ml', name: 'de aceite de oliva virgen extra'}, {amount: 30, unit: 'ml', name: 'de vinagre de Jerez'}, {amount: null, unit: '', name: 'Sal'}], steps: ["Lava y trocea las verduras.", "Pon todo en la batidora con el pan, aceite, vinagre y sal.", "Bate hasta que quede una crema fina.", "Enfría en la nevera antes de servir."] },
                { id: "lentejas-estofadas", name: "Lentejas Estofadas", category: "Primero", time: "50 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1625944132003-24153a812b1b?q=80&w=800", ingredients: [{amount: 400, unit: 'g', name: 'de lentejas pardinas'}, {amount: 1, unit: '', name: 'chorizo'}, {amount: 1, unit: '', name: 'patata'}, {amount: 1, unit: '', name: 'zanahoria'}, {amount: 1, unit: '', name: 'cebolla'}, {amount: 1, unit: '', name: 'hoja de laurel'}, {amount: 1, unit: 'cucharadita', name: 'de pimentón dulce'}], steps: ["Sofríe la cebolla y zanahoria picadas.", "Añade el chorizo y la patata en trozos. Rehoga.", "Incorpora las lentejas, el laurel y el pimentón.", "Cubre con agua, añade sal y cuece a fuego lento 40-50 minutos."] },
                { id: "sopa-de-ajo", name: "Sopa de Ajo (Castellana)", category: "Primero", time: "25 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Sopa+de+Ajo", ingredients: [{amount: 200, unit: 'g', name: 'de pan duro'}, {amount: 6, unit: '', name: 'dientes de ajo'}, {amount: 100, unit: 'g', name: 'de jamón serrano'}, {amount: 1, unit: 'cucharada', name: 'de pimentón dulce'}, {amount: 1, unit: 'litro', name: 'de caldo de pollo'}, {amount: 2, unit: '', name: 'huevos'}, {amount: null, unit: '', name: 'Aceite'}], steps: ["Corta el pan en rebanadas finas.", "Dora los ajos laminados y el jamón.", "Retira del fuego, añade el pimentón. Remueve.", "Añade el pan y el caldo. Cuece 15 min.", "Casca los huevos en la sopa y remueve para que se cuajen."] },
                { id: "ensaladilla-rusa", name: "Ensaladilla Rusa", category: "Primero", time: "40 min + reposo", servings: 6, difficulty: "Medio", image: "https://images.unsplash.com/photo-1604329227594-3d9697ac7249?q=80&w=800", ingredients: [{amount: 500, unit: 'g', name: 'de patatas'}, {amount: 2, unit: '', name: 'zanahorias'}, {amount: 2, unit: '', name: 'huevos'}, {amount: 1, unit: 'lata', name: 'de atún'}, {amount: 100, unit: 'g', name: 'de guisantes'}, {amount: null, unit: '', name: 'Aceitunas'}, {amount: 200, unit: 'g', name: 'de mayonesa'}], steps: ["Cuece las patatas, zanahorias y huevos.", "Pela y pica todo en dados pequeños.", "Mezcla la patata, zanahoria, huevo, atún, guisantes y aceitunas.", "Añade mayonesa y mezcla con cuidado.", "Deja enfriar en la nevera al menos 2 horas."] },
                { id: "salmorejo-cordobes", name: "Salmorejo Cordobés", category: "Primero", time: "15 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1598514982249-916212e62444?q=80&w=800", ingredients: [{amount: 1, unit: 'kg', name: 'de tomates pera'}, {amount: 200, unit: 'g', name: 'de pan de telera'}, {amount: 1, unit: '', name: 'diente de ajo'}, {amount: 100, unit: 'ml', name: 'de aceite de oliva'}, {amount: null, unit: '', name: 'Sal'}, {amount: 50, unit: 'g', name: 'de jamón serrano'}, {amount: 1, unit: '', name: 'huevo duro'}], steps: ["Tritura los tomates y cuélalos.", "Añade el pan, el ajo y la sal. Tritura.", "Emulsiona añadiendo el aceite en un hilo fino.", "Sirve frío con jamón y huevo duro picado."] },
                { id: "fabada-asturiana", name: "Fabada Asturiana", category: "Primero", time: "3 horas", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Fabada", ingredients: [{amount: 500, unit: 'g', name: 'de fabes'}, {amount: 2, unit: '', name: 'morcillas asturianas'}, {amount: 2, unit: '', name: 'chorizos asturianos'}, {amount: 200, unit: 'g', name: 'de panceta'}, {amount: null, unit: '', name: 'Azafrán'}], steps: ["Deja las fabes en remojo la noche anterior.", "Pon las fabes y el compango en una olla, cubre con agua fría y lleva a ebullición.", "Desespuma y baja el fuego. Cuece lentamente 2-3 horas.", "'Asusta' las fabes con agua fría un par de veces.", "Añade el azafrán al final y deja reposar."] },
                { id: "pisto-manchego", name: "Pisto Manchego", category: "Primero", time: "45 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1571991285272-46a2a078e515?q=80&w=800", ingredients: [{amount: 1, unit: '', name: 'cebolla'}, {amount: 2, unit: '', name: 'pimientos verdes'}, {amount: 1, unit: '', name: 'pimiento rojo'}, {amount: 1, unit: '', name: 'calabacín'}, {amount: 800, unit: 'g', name: 'de tomate triturado'}, {amount: null, unit: '', name: 'Aceite'}, {amount: null, unit: '', name: 'Sal'}], steps: ["Pica todas las verduras en dados.", "Pocha la cebolla y los pimientos.", "Añade el calabacín y cocina 15 minutos.", "Vierte el tomate y cocina a fuego lento 25 minutos."] },
                { id: "marmitako", name: "Marmitako", category: "Primero", time: "60 min", servings: 4, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Marmitako", ingredients: [{amount: 500, unit: 'g', name: 'de bonito del norte'}, {amount: 4, unit: '', name: 'patatas'}, {amount: 1, unit: '', name: 'cebolla'}, {amount: 2, unit: '', name: 'pimientos choriceros'}, {amount: 1, unit: '', name: 'pimiento verde'}, {amount: 1, unit: 'litro', name: 'de caldo de pescado'}], steps: ["Hidrata los pimientos choriceros y saca la pulpa.", "Sofríe la cebolla y pimiento verde.", "Añade las patatas cascadas y la pulpa del choricero. Rehoga.", "Cubre con caldo y cuece hasta que la patata esté tierna.", "Añade el bonito en dados y cuece 2 minutos. Deja reposar."] },
                { id: "crema-de-calabacin", name: "Crema de Calabacín", category: "Primero", time: "30 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1505586549231-c352c5f21533?q=80&w=800", ingredients: [{amount: 2, unit: '', name: 'calabacines'}, {amount: 1, unit: '', name: 'patata'}, {amount: 1, unit: '', name: 'cebolla'}, {amount: 100, unit: 'ml', name: 'de nata líquida (opcional)'}, {amount: 750, unit: 'ml', name: 'de caldo de verduras'}, {amount: 4, unit: '', name: 'quesitos'}], steps: ["Pocha la cebolla en una olla.", "Añade el calabacín y la patata en trozos. Rehoga.", "Cubre con caldo y cuece 20 minutos.", "Tritura todo con la batidora. Añade los quesitos y un chorrito de nata para más cremosidad.", "Sirve caliente."] },
                { id: "arroz-caldoso-con-bogavante", name: "Arroz con Bogavante", category: "Primero", time: "50 min", servings: 2, difficulty: "Difícil", image: "https://images.unsplash.com/photo-1598514983318-7293e6875953?q=80&w=800", ingredients: [{amount: 1, unit: '', name: 'bogavante'}, {amount: 200, unit: 'g', name: 'de arroz bomba'}, {amount: 1, unit: '', name: 'cebolla'}, {amount: 2, unit: '', name: 'dientes de ajo'}, {amount: 100, unit: 'g', name: 'de tomate triturado'}, {amount: 1, unit: 'litro', name: 'de fumet de pescado'}], steps: ["Sofríe el bogavante troceado y reserva.", "En el mismo aceite, haz un sofrito con la cebolla, ajo y tomate.", "Añade el arroz y nacara.", "Vierte el fumet caliente y cuece 15 minutos.", "Incorpora los trozos de bogavante y cuece 3 minutos más."] },
                { id: "porrusalda", name: "Porrusalda", category: "Primero", time: "35 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Porrusalda", ingredients: [{amount: 4, unit: '', name: 'puerros grandes'}, {amount: 2, unit: '', name: 'patatas'}, {amount: 1, unit: '', name: 'zanahoria'}, {amount: 1, unit: 'litro', name: 'de caldo de verduras o agua'}, {amount: null, unit: '', name: 'Aceite de oliva virgen extra'}, {amount: null, unit: '', name: 'Sal'}], steps: ["Limpia los puerros y córtalos en rodajas (solo la parte blanca y verde clara).", "Pela y chasca las patatas y la zanahoria.", "En una olla, pocha el puerro con aceite de oliva.", "Añade la patata y la zanahoria y rehoga unos minutos.", "Cubre con caldo, sazona y cuece a fuego medio hasta que las verduras estén tiernas (unos 20 minutos)."] },
                { id: "sopa-de-marisco", name: "Sopa de Marisco", category: "Primero", time: "50 min", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Sopa+Marisco", ingredients: [{amount: 250, unit: 'g', name: 'de cabezas de gambas y langostinos'}, {amount: 500, unit: 'g', name: 'de pescado de roca'}, {amount: 1, unit: '', name: 'puerro'}, {amount: 1, unit: '', name: 'zanahoria'}, {amount: 1, unit: '', name: 'tomate'}, {amount: 50, unit: 'ml', name: 'de brandy'}, {amount: 50, unit: 'g', name: 'de arroz (opcional)'}], steps: ["Tuesta las cabezas de marisco en una olla. Flambea con brandy.", "Añade las verduras y el pescado de roca. Cubre con agua y cuece 30 min.", "Cuela el caldo apretando bien.", "Cuece un poco de arroz o fideos en el caldo antes de servir."] },
                { id: "alubias-de-tolosa", name: "Alubias de Tolosa", category: "Primero", time: "2 horas", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Alubias+Tolosa", ingredients: [{amount: 500, unit: 'g', name: 'de alubias de Tolosa'}, {amount: 1, unit: '', name: 'berza'}, {amount: 1, unit: '', name: 'morcilla'}, {amount: 1, unit: '', name: 'chorizo'}, {amount: 150, unit: 'g', name: 'de panceta'}, {amount: null, unit: '', name: 'Guindillas de Ibarra'}], steps: ["Pon a cocer las alubias en agua fría.", "Cuando hiervan, añade el chorizo y la panceta.", "Cuece a fuego lento durante 2 horas. Añade la morcilla a mitad de cocción.", "Aparte, cuece la berza. Sirve las alubias con su compango, la berza y guindillas."] },
                { id: "migas-extremenas", name: "Migas Extremeñas", category: "Primero", time: "30 min + reposo", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Migas", ingredients: [{amount: 1, unit: 'kg', name: 'de pan duro'}, {amount: 200, unit: 'g', name: 'de panceta'}, {amount: 1, unit: '', name: 'chorizo'}, {amount: 2, unit: '', name: 'pimientos'}, {amount: 1, unit: 'cabeza', name: 'de ajos'}, {amount: null, unit: '', name: 'Agua'}, {amount: null, unit: '', name: 'Sal'}, {amount: 1, unit: 'cucharada', name: 'de pimentón de la Vera'}], steps: ["El día anterior, corta el pan en dados y humedécelo ligeramente con agua y sal.", "Fríe los pimientos y reserva. En el mismo aceite, fríe la panceta y el chorizo. Reserva.", "Dora los ajos y añade el pimentón.", "Incorpora el pan y remueve constantemente con una rasera a fuego medio hasta que las migas estén sueltas y doradas.", "Sirve con las carnes y los pimientos."] },
                { id: "espinacas-a-la-catalana", name: "Espinacas a la Catalana", category: "Primero", time: "20 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Espinacas", ingredients: [{amount: 500, unit: 'g', name: 'de espinacas frescas'}, {amount: 40, unit: 'g', name: 'de pasas'}, {amount: 40, unit: 'g', name: 'de piñones'}, {amount: 2, unit: '', name: 'dientes de ajo'}], steps: ["Pon las pasas en remojo.", "Tuesta los piñones en una sartén y reserva.", "Saltea los ajos laminados.", "Añade las espinacas y cocina hasta que reduzcan.", "Incorpora las pasas escurridas y los piñones. Saltea todo junto."] },
                { id: "arroz-negro", name: "Arroz Negro", category: "Primero", time: "40 min", servings: 4, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Arroz+Negro", ingredients: [{amount: 300, unit: 'g', name: 'de arroz bomba'}, {amount: 2, unit: '', name: 'calamares'}, {amount: 4, unit: '', name: 'tintas de calamar'}, {amount: 0.5, unit: '', name: 'cebolla'}, {amount: 1, unit: '', name: 'diente de ajo'}, {amount: 1, unit: 'litro', name: 'de fumet de pescado'}, {amount: null, unit: '', name: 'Alioli'}], steps: ["Sofríe la cebolla y el ajo. Añade el calamar en trozos y cocina.", "Disuelve la tinta en un poco de fumet.", "Añade el arroz y rehoga. Incorpora la tinta y el resto del fumet caliente.", "Cuece durante 18 minutos.", "Sirve con alioli."] },
                { id: "potaje-garbanzos", name: "Potaje de Garbanzos con Bacalao", category: "Primero", time: "1.5 horas", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Potaje", ingredients: [{amount: 400, unit: 'g', name: 'de garbanzos'}, {amount: 300, unit: 'g', name: 'de bacalao desalado'}, {amount: 1, unit: 'manojo', name: 'de espinacas'}, {amount: 1, unit: '', name: 'cebolla'}, {amount: 2, unit: '', name: 'huevos duros'}, {amount: 2, unit: '', name: 'dientes de ajo'}, {amount: 1, unit: 'cucharadita', name: 'de pimentón'}], steps: ["Deja los garbanzos en remojo la noche anterior.", "Cuece los garbanzos en una olla con agua.", "Haz un sofrito con cebolla, ajo y pimentón y añádelo a la olla.", "Cuando los garbanzos estén tiernos, añade las espinacas y el bacalao desmigado.", "Cuece 5 minutos más y sirve con huevo duro picado."] },
                { id: "crema-champinones", name: "Crema de Champiñones", category: "Primero", time: "30 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Crema+Champiñones", ingredients: [{amount: 500, unit: 'g', name: 'de champiñones'}, {amount: 1, unit: '', name: 'puerro'}, {amount: 1, unit: '', name: 'patata'}, {amount: 800, unit: 'ml', name: 'de caldo de pollo'}, {amount: 100, unit: 'ml', name: 'de nata líquida'}], steps: ["Limpia y trocea los champiñones y el puerro.", "Sofríe el puerro en una olla, luego añade los champiñones y la patata.", "Cubre con caldo y cuece 20 minutos.", "Tritura bien. Añade un chorro de nata y mezcla.", "Sirve caliente con picatostes."] },
                { id: "patatas-a-la-riojana", name: "Patatas a la Riojana", category: "Primero", time: "40 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Patatas+Riojana", ingredients: [{amount: 4, unit: '', name: 'patatas'}, {amount: 2, unit: '', name: 'chorizos riojanos'}, {amount: 1, unit: '', name: 'pimiento choricero'}, {amount: 1, unit: '', name: 'cebolla'}, {amount: 2, unit: '', name: 'dientes de ajo'}, {amount: null, unit: '', name: 'Sal'}, {amount: 1, unit: '', name: 'hoja de laurel'}], steps: ["Hidrata el pimiento choricero y saca la pulpa.", "Sofríe la cebolla y los ajos picados.", "Añade el chorizo en rodajas y rehoga.", "Incorpora las patatas cascadas y la pulpa del pimiento. Cubre con agua.", "Añade sal y laurel, y cuece hasta que la patata esté tierna."] },
                { id: "sopa-pescado", name: "Sopa de Pescado", category: "Primero", time: "45 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Sopa+Pescado", ingredients: [{amount: 250, unit: 'g', name: 'de merluza'}, {amount: 100, unit: 'g', name: 'de gambas'}, {amount: 1, unit: '', name: 'puerro'}, {amount: 1, unit: '', name: 'zanahoria'}, {amount: 1, unit: '', name: 'tomate'}, {amount: null, unit: '', name: 'Pan frito'}, {amount: 1, unit: 'litro', name: 'de fumet de pescado'}], steps: ["Pocha el puerro y la zanahoria.", "Añade el tomate rallado y cocina.", "Vierte el fumet de pescado y cuece 15 minutos. Tritura.", "Añade el pescado desmenuzado y las gambas peladas. Cuece 5 minutos.", "Sirve con pan frito."] },
                // 20 Segundos
                { id: "paella-valenciana", name: "Paella Valenciana", category: "Segundo", time: "60 min", servings: 4, difficulty: "Difícil", image: "https://images.unsplash.com/photo-1579871494474-a4b56a7d1ae9?q=80&w=800", ingredients: [{amount: 300, unit: 'g', name: 'de arroz bomba'}, {amount: 400, unit: 'g', name: 'de pollo'}, {amount: 300, unit: 'g', name: 'de conejo'}, {amount: 150, unit: 'g', name: 'de judía verde'}, {amount: 100, unit: 'g', name: 'de garrofón'}, {amount: null, unit: '', name: 'Azafrán'}], steps: ["Sofríe las carnes.", "Añade las verduras y el tomate.", "Incorpora el agua y, cuando hierva, el azafrán y el arroz.", "Cocina hasta que el arroz esté en su punto."] },
                { id: "rabo-de-toro", name: "Rabo de Toro Estofado", category: "Segundo", time: "4 horas", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Rabo+de+Toro", ingredients: [{amount: 1.5, unit: 'kg', name: 'de rabo de toro'}, {amount: 2, unit: '', name: 'cebollas'}, {amount: 2, unit: '', name: 'zanahorias'}, {amount: 1, unit: '', name: 'puerro'}, {amount: 500, unit: 'ml', name: 'de vino tinto'}, {amount: 500, unit: 'ml', name: 'de caldo de carne'}], steps: ["Salpimenta y enharina el rabo. Dóralo en una olla rápida.", "Sofríe las verduras picadas en el mismo aceite.", "Incorpora el rabo, el vino y el caldo.", "Cierra la olla y cuece durante 2 horas desde que suba la válvula.", "Deja reposar y sirve con puré de patatas."] },
                { id: "merluza-salsa-verde", name: "Merluza en Salsa Verde", category: "Segundo", time: "25 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1628203102432-159c3a35f795?q=80&w=800", ingredients: [{amount: 4, unit: 'lomos', name: 'de merluza'}, {amount: 200, unit: 'g', name: 'de almejas'}, {amount: 100, unit: 'g', name: 'de guisantes'}, {amount: 3, unit: '', name: 'dientes de ajo'}, {amount: null, unit: '', name: 'Perejil'}, {amount: 100, unit: 'ml', name: 'de vino blanco'}, {amount: 200, unit: 'ml', name: 'de fumet de pescado'}], steps: ["Dora los ajos en una cazuela.", "Coloca los lomos de merluza con la piel hacia arriba.", "Añade el vino, las almejas, los guisantes y el perejil picado.", "Vierte el fumet y cocina 10-15 minutos moviendo la cazuela en vaivén para ligar la salsa."] },
                { id: "pollo-al-ajillo", name: "Pollo al Ajillo", category: "Segundo", time: "40 min", servings: 4, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1606013022559-12f865ae487c?q=80&w=800", ingredients: [{amount: 1, unit: '', name: 'pollo troceado'}, {amount: 1, unit: 'cabeza', name: 'de ajos'}, {amount: 100, unit: 'ml', name: 'de vino blanco'}, {amount: 1, unit: '', name: 'hoja de laurel'}, {amount: null, unit: '', name: 'Aceite de oliva'}, {amount: null, unit: '', name: 'Sal'}], steps: ["Salpimenta el pollo y dóralo en una sartén.", "Añade los dientes de ajo sin pelar (con un corte) y el laurel.", "Vierte el vino blanco y deja que evapore el alcohol.", "Baja el fuego, tapa y cocina 20-25 minutos hasta que el pollo esté tierno."] },
                { id: "cochinillo-asado", name: "Cochinillo Asado", category: "Segundo", time: "3 horas", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Cochinillo", ingredients: [{amount: 1, unit: '', name: 'cochinillo de 4-5kg'}, {amount: 100, unit: 'g', name: 'de manteca de cerdo'}, {amount: 200, unit: 'ml', name: 'de agua'}, {amount: null, unit: '', name: 'Sal'}], steps: ["Coloca el cochinillo en una fuente de barro con la piel hacia abajo.", "Añade un dedo de agua en la fuente.", "Ásalo en el horno precalentado a 160°C durante 1.5 horas.", "Dale la vuelta, pínchale la piel, úntalo con manteca y sube el horno a 190°C.", "Asa 1 hora más hasta que la piel esté dorada y crujiente."] },
                { id: "bacalao-al-pil-pil", name: "Bacalao al Pil-Pil", category: "Segundo", time: "45 min", servings: 4, difficulty: "Difícil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Bacalao", ingredients: [{amount: 4, unit: 'lomos', name: 'de bacalao desalado'}, {amount: 6, unit: '', name: 'dientes de ajo'}, {amount: 2, unit: '', name: 'guindillas'}, {amount: 200, unit: 'ml', name: 'de aceite de oliva virgen extra'}], steps: ["Confita los lomos de bacalao en aceite con ajos y guindillas a fuego muy bajo.", "Retira el bacalao y deja templar el aceite.", "Vierte el aceite en un colador fino sobre un bol, moviendo en círculos para que la gelatina del pescado emulsione con el aceite y forme la salsa pil-pil."] },
                { id: "fideua", name: "Fideuà", category: "Segundo", time: "40 min", servings: 4, difficulty: "Medio", image: "https://images.unsplash.com/photo-1598514983318-7293e6875953?q=80&w=800", ingredients: [{amount: 300, unit: 'g', name: 'de fideos para fideuà'}, {amount: 200, unit: 'g', name: 'de gambas'}, {amount: 200, unit: 'g', name: 'de calamares'}, {amount: 250, unit: 'g', name: 'de mejillones'}, {amount: 1, unit: 'litro', name: 'de fumet de pescado'}], steps: ["Sofríe el marisco y reserva.", "En el mismo aceite, sofríe los fideos hasta que estén dorados.", "Añade un sofrito de tomate y pimiento.", "Incorpora el fumet caliente y cuece según el tiempo del fabricante.", "Añade el marisco y termina la cocción."] },
                { id: "albondigas-en-salsa", name: "Albóndigas en Salsa Española", category: "Segundo", time: "50 min", servings: 4, difficulty: "Medio", image: "https://images.unsplash.com/photo-1598514982249-916212e62444?q=80&w=800", ingredients: [{amount: 500, unit: 'g', name: 'de carne picada'}, {amount: 1, unit: '', name: 'huevo'}, {amount: 50, unit: 'g', name: 'de pan rallado'}, {amount: 2, unit: '', name: 'dientes de ajo'}, {amount: null, unit: '', name: 'Perejil'}, {amount: null, unit: '', name: 'Harina'}, {amount: 1, unit: '', name: 'cebolla'}, {amount: 1, unit: '', name: 'zanahoria'}, {amount: 100, unit: 'ml', name: 'de vino tinto'}, {amount: 400, unit: 'ml', name: 'de caldo'}], steps: ["Mezcla la carne con huevo, pan, ajo y perejil. Forma las albóndigas.", "Pásalas por harina y fríelas. Reserva.", "En el mismo aceite, pocha las verduras para la salsa.", "Añade el vino y el caldo. Tritura la salsa.", "Incorpora las albóndigas y cuece 20 minutos."] },
                { id: "cordero-asado", name: "Cordero Asado", category: "Segundo", time: "2 horas", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Cordero", ingredients: [{amount: 1, unit: '', name: 'paletilla de cordero lechal'}, {amount: 100, unit: 'ml', name: 'de agua'}, {amount: null, unit: '', name: 'Sal'}, {amount: 50, unit: 'g', name: 'de manteca de cerdo'}], steps: ["Precalienta el horno a 180°C.", "Coloca la paletilla con la piel hacia abajo en una fuente.", "Añade un poco de agua y sal. Asa durante 1 hora.", "Dale la vuelta, unta con manteca y asa 45 minutos más hasta que esté dorada."] },
                { id: "calamares-en-su-tinta", name: "Calamares en su Tinta", category: "Segundo", time: "60 min", servings: 4, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Calamares", ingredients: [{amount: 1, unit: 'kg', name: 'de calamares'}, {amount: 2, unit: '', name: 'cebollas'}, {amount: 2, unit: 'bolsitas', name: 'de tinta de calamar'}, {amount: 100, unit: 'ml', name: 'de vino blanco'}, {amount: 200, unit: 'ml', name: 'de fumet de pescado'}], steps: ["Limpia los calamares, reserva las tintas y los tentáculos.", "Pica los tentáculos y sofríelos con cebolla para el relleno.", "Rellena los calamares y ciérralos con un palillo.", "Sofríe los calamares rellenos. En la misma cazuela, pocha la otra cebolla, añade el vino y la tinta diluida.", "Cubre con fumet y cuece a fuego lento 40 minutos."] },
                { id: "zarzuela-pescado", name: "Zarzuela de Pescado", category: "Segundo", time: "50 min", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Zarzuela", ingredients: [{amount: 400, unit: 'g', name: 'de rape'}, {amount: 250, unit: 'g', name: 'de calamares'}, {amount: 8, unit: '', name: 'langostinos'}, {amount: 8, unit: '', name: 'mejillones'}, {amount: 1, unit: '', name: 'cebolla'}, {amount: 2, unit: '', name: 'dientes de ajo'}, {amount: 200, unit: 'g', name: 'de tomate triturado'}, {amount: 100, unit: 'ml', name: 'de vino blanco'}, {amount: 500, unit: 'ml', name: 'de fumet de pescado'}, {amount: 20, unit: 'g', name: 'de almendras tostadas para picada'}], steps: ["Sofríe los langostinos y el rape y reserva.", "En el mismo aceite, pocha la cebolla y el ajo.", "Añade los calamares y el tomate. Cocina 10 minutos.", "Vierte el vino blanco y deja reducir. Añade el fumet.", "Incorpora el pescado, los langostinos y los mejillones (abiertos al vapor).", "Añade una picada de ajo, perejil y almendras y cuece todo junto 5 minutos."] },
                { id: "cachopo-asturiano", name: "Cachopo Asturiano", category: "Segundo", time: "30 min", servings: 2, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Cachopo", ingredients: [{amount: 2, unit: 'filetes grandes', name: 'de ternera'}, {amount: 4, unit: 'lonchas', name: 'de jamón serrano'}, {amount: 4, unit: 'lonchas', name: 'de queso'}, {amount: 2, unit: '', name: 'huevos'}, {amount: null, unit: '', name: 'Pan rallado'}, {amount: null, unit: '', name: 'Aceite para freír'}], steps: ["Extiende un filete, cubre con jamón y queso, y tapa con el otro filete.", "Presiona bien los bordes.", "Pasa el cachopo por huevo batido y luego por pan rallado.", "Fríelo en abundante aceite caliente hasta que esté dorado por ambos lados."] },
                { id: "trucha-a-la-navarra", name: "Trucha a la Navarra", category: "Segundo", time: "20 min", servings: 2, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Trucha+Navarra", ingredients: [{amount: 2, unit: '', name: 'truchas limpias'}, {amount: 4, unit: 'lonchas', name: 'de jamón serrano'}, {amount: 2, unit: '', name: 'dientes de ajo'}, {amount: null, unit: '', name: 'Aceite de oliva'}, {amount: null, unit: '', name: 'Harina'}], steps: ["Sazona las truchas por dentro y por fuera.", "Introduce dos lonchas de jamón en cada trucha.", "Pasa las truchas por harina y fríelas en una sartén con aceite.", "En el mismo aceite, dora unos ajos laminados y viértelos sobre las truchas al servir."] },
                { id: "pollo-en-pepitoria", name: "Pollo en Pepitoria", category: "Segundo", time: "60 min", servings: 4, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Pollo+Pepitoria", ingredients: [{amount: 1, unit: '', name: 'pollo troceado'}, {amount: 2, unit: '', name: 'huevos duros'}, {amount: null, unit: '', name: 'Azafrán'}, {amount: 30, unit: 'g', name: 'de almendras tostadas'}, {amount: 500, unit: 'ml', name: 'de caldo de pollo'}, {amount: 1, unit: '', name: 'cebolla'}, {amount: 2, unit: '', name: 'dientes de ajo'}], steps: ["Dora el pollo enharinado y reserva.", "Sofríe la cebolla y el ajo. Añade el pollo.", "Maja las yemas de los huevos duros con el azafrán y las almendras. Deslíe con un poco de caldo.", "Vierte la mezcla sobre el pollo y añade más caldo. Cuece 40 minutos.", "Sirve con las claras de huevo picadas."] },
                { id: "callos-a-la-madrilena", name: "Callos a la Madrileña", category: "Segundo", time: "3 horas", servings: 6, difficulty: "Difícil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Callos", ingredients: [{amount: 1, unit: 'kg', name: 'de callos de ternera'}, {amount: 250, unit: 'g', name: 'de morro y pata de ternera'}, {amount: 1, unit: '', name: 'chorizo'}, {amount: 1, unit: '', name: 'morcilla'}, {amount: 100, unit: 'g', name: 'de jamón serrano'}, {amount: 1, unit: 'cucharada', name: 'de pimentón'}, {amount: 1, unit: '', name: 'guindilla'}], steps: ["Limpia y cuece los callos, el morro y la pata en olla rápida durante 1 hora.", "Sofríe cebolla y ajo, añade jamón, chorizo, pimentón y guindilla.", "Incorpora los callos y su caldo de cocción.", "Añade la morcilla y cuece todo a fuego lento durante 2 horas."] },
                { id: "chipirones-en-su-tinta", name: "Chipirones en su Tinta", category: "Segundo", time: "50 min", servings: 4, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Chipirones", ingredients: [{amount: 1, unit: 'kg', name: 'de chipirones'}, {amount: 2, unit: '', name: 'cebollas'}, {amount: 2, unit: 'bolsitas', name: 'de tinta de chipirón'}, {amount: 100, unit: 'ml', name: 'de vino blanco'}, {amount: null, unit: '', name: 'Arroz blanco para acompañar'}], steps: ["Limpia los chipirones, guardando las tintas. Rellena los cuerpos con las patas.", "Sofríe la cebolla muy picada. Añade los chipirones y el vino.", "Diluye la tinta en agua y añádela. Cuece a fuego lento 30-40 minutos.", "Sirve con arroz blanco."] },
                { id: "ternera-jardinera", name: "Ternera a la Jardinera", category: "Segundo", time: "1.5 horas", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Ternera+Jardinera", ingredients: [{amount: 800, unit: 'g', name: 'de ternera para guisar'}, {amount: 150, unit: 'g', name: 'de guisantes'}, {amount: 2, unit: '', name: 'zanahorias'}, {amount: 2, unit: '', name: 'patatas'}, {amount: 1, unit: '', name: 'cebolla'}, {amount: 100, unit: 'ml', name: 'de vino blanco'}, {amount: 500, unit: 'ml', name: 'de caldo de carne'}], steps: ["Sella la ternera en una olla. Reserva.", "Sofríe la cebolla. Añade la ternera y el vino.", "Cubre con caldo y cuece 1 hora.", "Añade las patatas, zanahorias y guisantes. Cuece 20 minutos más."] },
                { id: "solomillo-al-whisky", name: "Solomillo al Whisky", category: "Segundo", time: "25 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Solomillo+Whisky", ingredients: [{amount: 1, unit: '', name: 'solomillo de cerdo'}, {amount: 100, unit: 'ml', name: 'de whisky'}, {amount: 4, unit: '', name: 'dientes de ajo'}, {amount: 1, unit: '', name: 'zumo de limón'}, {amount: null, unit: '', name: 'Aceite de oliva'}], steps: ["Corta el solomillo en medallones y dóralos. Reserva.", "En la misma sartén, dora los ajos laminados.", "Vierte el whisky y el zumo de limón. Deja que reduzca.", "Incorpora de nuevo el solomillo y cocina un par de minutos."] },
                { id: "atun-encebollado", name: "Atún Encebollado", category: "Segundo", time: "30 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Atún+Encebollado", ingredients: [{amount: 4, unit: 'rodajas', name: 'de atún fresco'}, {amount: 2, unit: '', name: 'cebollas grandes'}, {amount: 100, unit: 'ml', name: 'de vino blanco'}, {amount: 1, unit: '', name: 'hoja de laurel'}, {amount: null, unit: '', name: 'Orégano'}], steps: ["Corta las cebollas en juliana y póchalas a fuego lento.", "Cuando esté transparente, añade el vino y el laurel. Cuece 10 minutos.", "Marca el atún en una plancha, vuelta y vuelta.", "Sirve el atún con la cebolla por encima y espolvorea orégano."] },
                { id: "caldereta-cordero", name: "Caldereta de Cordero", category: "Segundo", time: "2 horas", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Caldereta", ingredients: [{amount: 1, unit: 'kg', name: 'de cordero en trozos'}, {amount: 1, unit: '', name: 'cebolla'}, {amount: 2, unit: '', name: 'pimientos'}, {amount: 2, unit: '', name: 'tomates'}, {amount: 4, unit: '', name: 'dientes de ajo'}, {amount: 150, unit: 'ml', name: 'de vino tinto'}, {amount: 1, unit: 'cucharadita', name: 'de pimentón'}], steps: ["Dora el cordero en una cazuela. Reserva.", "Sofríe las verduras picadas.", "Añade pimentón, el cordero y el vino. Deja reducir.", "Cubre con agua o caldo y cuece a fuego lento 1.5 - 2 horas."] },
                // 20 Postres
                { id: "crema-catalana", name: "Crema Catalana", category: "Postre", time: "25 min + reposo", servings: 6, difficulty: "Medio", image: "https://images.unsplash.com/photo-1621244249146-2169820786a3?q=80&w=800", ingredients: [{amount: 1, unit: 'litro', name: 'de leche'}, {amount: 8, unit: '', name: 'yemas de huevo'}, {amount: 200, unit: 'g', name: 'de azúcar'}, {amount: 40, unit: 'g', name: 'de maicena'}, {amount: 1, unit: '', name: 'piel de limón y naranja'}, {amount: 1, unit: 'rama', name: 'de canela'}], steps: ["Infusiona la leche con los cítricos y la canela.", "Mezcla yemas, azúcar y maicena.", "Cuela la leche y mézclala con las yemas.", "Cocina a fuego lento hasta que espese. Enfría.", "Quema azúcar en la superficie antes de servir."] },
                { id: "tarta-de-santiago", name: "Tarta de Santiago", category: "Postre", time: "45 min", servings: 10, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Tarta+Santiago", ingredients: [{amount: 250, unit: 'g', name: 'de almendra molida'}, {amount: 250, unit: 'g', name: 'de azúcar'}, {amount: 5, unit: '', name: 'huevos'}, {amount: 1, unit: '', name: 'ralladura de limón'}, {amount: null, unit: '', name: 'Azúcar glas para decorar'}], steps: ["Mezcla la almendra y el azúcar.", "Añade los huevos de uno en uno, batiendo bien.", "Incorpora la ralladura de limón.", "Vierte en un molde engrasado y hornea a 170°C durante 30-35 minutos.", "Deja enfriar y decora con la Cruz de Santiago hecha con azúcar glas."] },
                { id: "arroz-con-leche", name: "Arroz con Leche", category: "Postre", time: "50 min", servings: 6, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1599043513901-3c5b52f6b3a2?q=80&w=800", ingredients: [{amount: 1, unit: 'litro', name: 'de leche entera'}, {amount: 100, unit: 'g', name: 'de arroz'}, {amount: 120, unit: 'g', name: 'de azúcar'}, {amount: 1, unit: '', name: 'piel de limón'}, {amount: 1, unit: 'rama', name: 'de canela'}], steps: ["Pon a cocer el arroz con la leche, la piel de limón y la canela.", "Cocina a fuego muy lento durante 45 minutos, removiendo a menudo.", "Añade el azúcar y cuece 5 minutos más.", "Retira la canela y el limón. Sirve frío o templado con canela en polvo."] },
                { id: "flan-de-huevo", name: "Flan de Huevo", category: "Postre", time: "60 min", servings: 8, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1617344539352-75c6d5b0a3c4?q=80&w=800", ingredients: [{amount: 5, unit: '', name: 'huevos'}, {amount: 500, unit: 'ml', name: 'de leche'}, {amount: 150, unit: 'g', name: 'de azúcar'}, {amount: null, unit: '', name: 'Caramelo líquido'}], steps: ["Bate los huevos con el azúcar.", "Calienta la leche y viértela sobre los huevos sin dejar de batir.", "Cubre el fondo de una flanera con caramelo líquido.", "Vierte la mezcla en la flanera y cocina al baño maría en el horno a 180°C durante 45-50 minutos."] },
                { id: "torrijas", name: "Torrijas de Leche", category: "Postre", time: "30 min", servings: 8, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1584879555239-444f0b784a3c?q=80&w=800", ingredients: [{amount: 1, unit: 'barra', name: 'de pan del día anterior'}, {amount: 1, unit: 'litro', name: 'de leche'}, {amount: 150, unit: 'g', name: 'de azúcar'}, {amount: 1, unit: 'rama', name: 'de canela'}, {amount: 1, unit: '', name: 'piel de limón'}, {amount: 2, unit: '', name: 'huevos'}, {amount: null, unit: '', name: 'Aceite para freír'}], steps: ["Infusiona la leche con azúcar, canela y limón.", "Corta el pan en rebanadas gruesas y empápalas en la leche infusionada.", "Pasa las rebanadas por huevo batido.", "Fríelas en aceite caliente hasta que estén doradas.", "Escúrrelas y rebózalas en una mezcla de azúcar y canela."] },
                { id: "leche-frita", name: "Leche Frita", category: "Postre", time: "30 min + reposo", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Leche+Frita", ingredients: [{amount: 500, unit: 'ml', name: 'de leche'}, {amount: 100, unit: 'g', name: 'de azúcar'}, {amount: 50, unit: 'g', name: 'de maicena'}, {amount: 1, unit: 'rama', name: 'de canela'}, {amount: 1, unit: '', name: 'piel de limón'}, {amount: 2, unit: '', name: 'huevos y harina para rebozar'}], steps: ["Disuelve la maicena en un poco de leche fría.", "Calienta el resto de la leche con azúcar, canela y limón. Cuela.", "Añade la mezcla de maicena y cocina hasta que espese mucho.", "Vierte en una fuente y deja enfriar hasta que solidifique.", "Corta en porciones, pasa por harina y huevo y fríe. Rebózalas en azúcar y canela."] },
                { id: "filloas-gallegas", name: "Filloas Gallegas", category: "Postre", time: "30 min", servings: 12, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Filloas", ingredients: [{amount: 250, unit: 'ml', name: 'de leche'}, {amount: 3, unit: '', name: 'huevos'}, {amount: 100, unit: 'g', name: 'de harina'}, {amount: 50, unit: 'g', name: 'de azúcar'}, {amount: null, unit: '', name: 'Un trozo de tocino para engrasar'}], steps: ["Bate los huevos con el azúcar.", "Añade la leche y la harina tamizada. Mezcla hasta obtener una masa líquida y sin grumos.", "Unta una sartén caliente con el tocino.", "Vierte un cucharón de masa y extiéndela para que quede una capa fina.", "Cocina por ambos lados y repite hasta acabar la masa. Sírvelas con azúcar, miel o mermelada."] },
                { id: "tarta-de-queso-la-vina", name: "Tarta de Queso 'La Viña'", category: "Postre", time: "60 min", servings: 12, difficulty: "Fácil", image: "https://images.unsplash.com/photo-1567613768463-b9254d39994f?q=80&w=800", ingredients: [{amount: 1, unit: 'kg', name: 'de queso crema'}, {amount: 500, unit: 'ml', name: 'de nata (35% M.G.)'}, {amount: 7, unit: '', name: 'huevos'}, {amount: 400, unit: 'g', name: 'de azúcar'}, {amount: 1, unit: 'cucharada', name: 'de harina'}], steps: ["Bate el queso crema con el azúcar.", "Añade los huevos uno a uno.", "Incorpora la nata y la harina. Mezcla bien.", "Vierte en un molde forrado con papel de horno arrugado.", "Hornea a 210°C durante 40-50 minutos. El centro debe quedar tembloroso.", "Deja enfriar por completo antes de desmoldar."] },
                { id: "panellets", name: "Panellets", category: "Postre", time: "40 min", servings: 20, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Panellets", ingredients: [{amount: 250, unit: 'g', name: 'de almendra molida'}, {amount: 200, unit: 'g', name: 'de azúcar'}, {amount: 1, unit: '', name: 'clara de huevo'}, {amount: 1, unit: '', name: 'ralladura de limón'}, {amount: 100, unit: 'g', name: 'de piñones para decorar'}], steps: ["Mezcla la almendra, el azúcar y la ralladura de limón.", "Añade la clara de huevo y amasa hasta obtener un mazapán.", "Forma bolitas, rebózalas en piñones.", "Píntalas con yema de huevo y hornea a 180°C durante 10-15 minutos."] },
                { id: "tocino-de-cielo", name: "Tocino de Cielo", category: "Postre", time: "50 min", servings: 8, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Tocino+Cielo", ingredients: [{amount: 10, unit: '', name: 'yemas de huevo'}, {amount: 250, unit: 'g', name: 'de azúcar'}, {amount: 150, unit: 'ml', name: 'de agua'}, {amount: null, unit: '', name: 'Caramelo líquido'}], steps: ["Haz un almíbar a punto de bola con el agua y el azúcar.", "Bate las yemas en un bol.", "Vierte el almíbar templado sobre las yemas en un hilo fino, sin dejar de batir.", "Cubre el fondo de un molde con caramelo.", "Vierte la mezcla y cocina al baño maría en el horno a 160°C durante 30 minutos."] },
                { id: "piononos", name: "Piononos de Santa Fe", category: "Postre", time: "40 min", servings: 12, difficulty: "Difícil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Piononos", ingredients: [{amount: 2, unit: '', name: 'huevos'}, {amount: 60, unit: 'g', name: 'de azúcar'}, {amount: 60, unit: 'g', name: 'de harina'}, {amount: 100, unit: 'g', name: 'de azúcar para almíbar'}, {amount: 100, unit: 'ml', name: 'de agua'}, {amount: 2, unit: '', name: 'yemas para crema'}, {amount: 50, unit: 'g', name: 'de azúcar para crema'}, {amount: 250, unit: 'ml', name: 'de leche'}], steps: ["Hornea una plancha fina de bizcocho y enróllala en caliente.", "Prepara un almíbar y empapa el bizcocho.", "Haz una crema pastelera con las yemas, azúcar y leche. Rellena el bizcocho y enróllalo de nuevo.", "Corta en porciones, corona con más crema y quema azúcar por encima."] },
                { id: "pestinos", name: "Pestiños", category: "Postre", time: "50 min", servings: 20, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Pestiños", ingredients: [{amount: 250, unit: 'g', name: 'de harina'}, {amount: 100, unit: 'ml', name: 'de vino blanco'}, {amount: 100, unit: 'ml', name: 'de aceite de oliva'}, {amount: 1, unit: '', name: 'ralladura de limón'}, {amount: 200, unit: 'g', name: 'de miel'}, {amount: null, unit: '', name: 'Ajonjolí'}], steps: ["Calienta el aceite con la piel de limón. Deja enfriar.", "Mezcla la harina, el vino y el aceite. Amasa.", "Estira la masa muy fina, corta cuadrados y dobla las puntas opuestas hacia el centro.", "Fríe en abundante aceite caliente.", "Pasa los pestiños por miel caliente y espolvorea ajonjolí."] },
                { id: "tarta-de-la-abuela", name: "Tarta de la Abuela", category: "Postre", time: "30 min + reposo", servings: 10, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Tarta+Abuela", ingredients: [{amount: 2, unit: 'paquetes', name: 'de galletas María'}, {amount: 500, unit: 'ml', name: 'de leche'}, {amount: 1, unit: 'sobre', name: 'de flan en polvo'}, {amount: 200, unit: 'g', name: 'de chocolate para postres'}, {amount: 100, unit: 'ml', name: 'de nata'}], steps: ["Prepara el flan siguiendo las instrucciones del paquete.", "En un molde, pon una capa de galletas mojadas en leche.", "Cubre con una capa de flan. Repite las capas.", "Funde el chocolate con la nata y cubre la tarta.", "Deja enfriar en la nevera varias horas."] },
                { id: "cuajada", name: "Cuajada con Miel y Nueces", category: "Postre", time: "10 min", servings: 6, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Cuajada", ingredients: [{amount: 1, unit: 'litro', name: 'de leche de oveja'}, {amount: 1, unit: 'cucharadita', name: 'de cuajo'}, {amount: null, unit: '', name: 'Miel'}, {amount: null, unit: '', name: 'Nueces'}], steps: ["Calienta la leche hasta que esté tibia (unos 37°C).", "Añade unas gotas de cuajo y remueve.", "Vierte en recipientes individuales y deja reposar sin mover hasta que cuaje.", "Sirve con un chorro de miel y nueces por encima."] },
                { id: "rosquillas-de-anis", name: "Rosquillas de Anís", category: "Postre", time: "40 min", servings: 24, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Rosquillas", ingredients: [{amount: 3, unit: '', name: 'huevos'}, {amount: 200, unit: 'g', name: 'de azúcar'}, {amount: 100, unit: 'ml', name: 'de anís'}, {amount: 100, unit: 'ml', name: 'de aceite'}, {amount: 500, unit: 'g', name: 'de harina'}, {amount: 1, unit: 'sobre', name: 'de levadura'}], steps: ["Bate los huevos con el azúcar. Añade el aceite y el anís.", "Incorpora la harina y la levadura poco a poco hasta formar una masa manejable.", "Forma las rosquillas.", "Fríelas en aceite caliente y rebózalas en azúcar."] },
                { id: "yemas-santa-teresa", name: "Yemas de Santa Teresa", category: "Postre", time: "30 min", servings: 12, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Yemas", ingredients: [{amount: 6, unit: '', name: 'yemas de huevo'}, {amount: 100, unit: 'g', name: 'de azúcar'}, {amount: 50, unit: 'ml', name: 'de agua'}, {amount: 1, unit: '', name: 'ralladura de limón'}], steps: ["Haz un almíbar a punto de bola con el agua y el azúcar.", "Bate las yemas y vierte el almíbar en un hilo fino.", "Cocina la mezcla al baño maría, sin dejar de remover, hasta que espese.", "Deja enfriar la masa. Forma bolitas y rebózalas en azúcar."] },
                { id: "goxua", name: "Goxua", category: "Postre", time: "40 min", servings: 6, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Goxua", ingredients: [{amount: 200, unit: 'ml', name: 'de nata montada'}, {amount: 300, unit: 'ml', name: 'de crema pastelera'}, {amount: 6, unit: '', name: 'bizcochos de soletilla'}, {amount: null, unit: '', name: 'Caramelo líquido'}], steps: ["En un vaso o copa, pon una base de nata montada.", "Cubre con trozos de bizcocho empapados en almíbar.", "Añade una capa generosa de crema pastelera.", "Quema azúcar por encima con un soplete o sirve con caramelo líquido."] },
                { id: "brazo-de-gitano", name: "Brazo de Gitano", category: "Postre", time: "50 min", servings: 8, difficulty: "Medio", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Brazo+Gitano", ingredients: [{amount: 4, unit: '', name: 'huevos'}, {amount: 120, unit: 'g', name: 'de azúcar'}, {amount: 120, unit: 'g', name: 'de harina'}, {amount: 300, unit: 'ml', name: 'de crema pastelera, nata o trufa para rellenar'}, {amount: null, unit: '', name: 'Azúcar glas'}], steps: ["Bate los huevos con el azúcar hasta que blanqueen.", "Añade la harina con movimientos envolventes.", "Extiende en una bandeja de horno con papel y hornea 10 min a 180°C.", "Vuelca sobre un paño húmedo, enrolla y deja enfriar.", "Desenrolla, rellena y vuelve a enrollar. Espolvorea azúcar glas."] },
                { id: "peras-al-vino", name: "Peras al Vino", category: "Postre", time: "40 min", servings: 4, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Peras+al+Vino", ingredients: [{amount: 4, unit: '', name: 'peras'}, {amount: 500, unit: 'ml', name: 'de vino tinto'}, {amount: 150, unit: 'g', name: 'de azúcar'}, {amount: 1, unit: 'rama', name: 'de canela'}, {amount: 1, unit: '', name: 'piel de limón'}], steps: ["Pela las peras dejando el rabito.", "En una cazuela, pon el vino, azúcar, canela y limón.", "Introduce las peras y cuece a fuego lento durante 30 minutos, dándoles la vuelta a mitad de cocción.", "Deja enfriar las peras en el propio almíbar."] },
                { id: "miguelitos-de-la-roda", name: "Miguelitos de La Roda", category: "Postre", time: "25 min", servings: 12, difficulty: "Fácil", image: "https://placehold.co/800x600/a38b72/4a2e0a?text=Miguelitos", ingredients: [{amount: 1, unit: 'plancha', name: 'de hojaldre'}, {amount: 200, unit: 'ml', name: 'de crema pastelera'}, {amount: null, unit: '', name: 'Azúcar glas'}], steps: ["Precalienta el horno a 200°C.", "Corta el hojaldre en cuadrados y hornéalos hasta que se inflen y estén dorados.", "Déjalos enfriar.", "Ábrelos por la mitad con cuidado y rellénalos con crema pastelera.", "Espolvorea con abundante azúcar glas."] }
            ];
            
            function initializeUI() {
                let recipeHTML = '';
                allRecipes.forEach(recipe => {
                    const searchTerms = `${recipe.name.toLowerCase()} ${recipe.ingredients.map(i => i.name).join(' ').toLowerCase()}`;
                    recipeHTML += `
                        <div class="recipe-card" data-id="${recipe.id}" data-category="${recipe.category}" data-search="${searchTerms}">
                            <div class="relative bg-white dark:bg-stone-800 rounded-lg shadow-md overflow-hidden transform hover:-translate-y-1 transition-transform duration-300 cursor-pointer h-full flex flex-col">
                                <img src="${recipe.image}" alt="[Imagen de ${recipe.name}]" class="w-full h-40 object-cover" loading="lazy" onerror="this.onerror=null;this.src='https://placehold.co/400x300/d1c4b5/4a2e0a?text=Receta';">
                                <div class="absolute top-2 left-2 bg-amber-800 text-white text-xs font-semibold px-2 py-1 rounded-full">${recipe.category}</div>
                                <button class="favorite-btn absolute top-2 right-2 bg-white/80 rounded-full p-2 hover:bg-white dark:bg-stone-700/80 dark:hover:bg-stone-600 transition">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600 dark:text-gray-400 pointer-events-none" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 016.364 0L12 7.636l1.318-1.318a4.5 4.5 0 016.364 6.364L12 20.364l-7.682-7.682a4.5 4.5 0 010-6.364z" /></svg>
                                </button>
                                <div class="p-4 flex-grow flex flex-col">
                                    <h3 class="font-bold text-lg text-amber-900 dark:text-amber-500 truncate">${recipe.name}</h3>
                                    <div class="flex items-center text-sm text-gray-500 dark:text-stone-400 mt-2">
                                        <span>${recipe.time}</span><span class="mx-2">|</span><span>${recipe.difficulty}</span>
                                    </div>
                                </div>
                            </div>
                        </div>`;
                });
                dom.grid.innerHTML = recipeHTML;
                addCardEventListeners();
            }
            
            function addCardEventListeners() {
                document.querySelectorAll('.recipe-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const recipe = allRecipes.find(r => r.id === card.dataset.id);
                        if (recipe) showRecipeDetail(recipe);
                    });
                    card.querySelector('.favorite-btn').addEventListener('click', e => {
                        e.stopPropagation();
                        toggleFavorite(card.dataset.id);
                    });
                });
            }
            
            initializeUI();

            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    userId = user.uid;
                    dom.userInfo.textContent = `Sincronizando favoritos...`;
                    await loadUserFavorites();
                    updateFavoriteIcons();
                    dom.userInfo.textContent = `ID de sesión: ${userId.substring(0,8)}...`;
                } else {
                    signInAnonymously(auth).catch((error) => console.error("Error login anónimo:", error));
                }
            });

            async function loadUserFavorites() {
                if (!userId) return;
                const userDocRef = doc(db, `artifacts/${appId}/users/${userId}/data/profile`);
                const userDoc = await getDoc(userDocRef);
                userFavorites = userDoc.exists() ? (userDoc.data().favorites || []) : [];
            }

            async function toggleFavorite(recipeId) {
                if (!userId) {
                    alert("Necesitas estar conectado para guardar favoritos.");
                    return;
                }
                const isFavorite = userFavorites.includes(recipeId);
                userFavorites = isFavorite ? userFavorites.filter(id => id !== recipeId) : [...userFavorites, recipeId];
                
                updateFavoriteIcons();
                applyFilters();

                const userDocRef = doc(db, `artifacts/${appId}/users/${userId}/data/profile`);
                await setDoc(userDocRef, { favorites: userFavorites });
            }

            function updateFavoriteIcons() {
                document.querySelectorAll('.recipe-card').forEach(card => {
                    const heartIcon = card.querySelector('.favorite-btn svg');
                    if (userFavorites.includes(card.dataset.id)) {
                        heartIcon.classList.add('text-red-500', 'fill-current');
                        heartIcon.classList.remove('text-gray-600', 'dark:text-gray-400');
                    } else {
                        heartIcon.classList.remove('text-red-500', 'fill-current');
                        heartIcon.classList.add('text-gray-600', 'dark:text-gray-400');
                    }
                });
            }

            function applyFilters() {
                const searchTerm = dom.search.value.toLowerCase();
                let visibleCount = 0;

                document.querySelectorAll('.recipe-card').forEach(card => {
                    const id = card.dataset.id;
                    const category = card.dataset.category;
                    const searchData = card.dataset.search;

                    const isFavorite = userFavorites.includes(id);
                    
                    const categoryMatch = currentCategory === 'all' || category === currentCategory;
                    const searchMatch = searchTerm === '' || searchData.includes(searchTerm);
                    const favoriteMatch = currentFilter !== 'favorites' || isFavorite;
                    
                    if (categoryMatch && searchMatch && favoriteMatch) {
                        card.classList.remove('hidden');
                        visibleCount++;
                    } else {
                        card.classList.add('hidden');
                    }
                });

                dom.noResults.style.display = visibleCount === 0 ? 'block' : 'none';
            }
            
            function showRecipeDetail(recipe) {
                dom.modalContent.innerHTML = `
                    <div class="p-6 md:p-8">
                        <div class="flex justify-between items-start">
                            <h2 class="text-3xl font-bold text-amber-900 dark:text-amber-500 mb-4">${recipe.name}</h2>
                            <button id="closeModalBtn" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-stone-700 transition">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                            </button>
                        </div>
                        <img src="${recipe.image}" alt="[Imagen de ${recipe.name}]" class="w-full h-64 object-cover rounded-lg mb-6" loading="lazy" onerror="this.onerror=null;this.src='https://placehold.co/600x400/d1c4b5/4a2e0a?text=Receta';">
                        <div id="recipe-content-normal">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <div>
                                    <div class="flex justify-between items-center mb-3">
                                        <h4 class="text-xl font-semibold border-b-2 border-amber-200 dark:border-amber-800 pb-2">Ingredientes</h4>
                                        <div class="flex items-center gap-2">
                                            <label for="servings-input" class="text-sm">Porciones:</label>
                                            <input type="number" id="servings-input" value="${recipe.servings}" min="1" class="w-16 p-1 border rounded dark:bg-stone-700 dark:border-stone-600">
                                        </div>
                                    </div>
                                    <ul id="ingredient-list" class="list-disc list-inside space-y-2 text-gray-700 dark:text-stone-300"></ul>
                                </div>
                                <div>
                                    <h4 class="text-xl font-semibold mb-3 border-b-2 border-amber-200 dark:border-amber-800 pb-2">Pasos</h4>
                                    <ol class="list-decimal list-inside space-y-3 text-gray-700 dark:text-stone-300">${recipe.steps.map(step => `<li>${step}</li>`).join('')}</ol>
                                </div>
                            </div>
                             <div class="modal-buttons-container text-center mt-8 flex flex-wrap gap-4 justify-center">
                                <button id="cookingModeBtn" class="bg-amber-800 text-white px-6 py-3 rounded-full font-semibold hover:bg-amber-900 transition shadow-lg">Activar Modo Cocina</button>
                                <button id="printRecipeBtn" class="bg-gray-500 text-white px-6 py-3 rounded-full font-semibold hover:bg-gray-600 transition shadow-lg">Imprimir</button>
                                <button id="shareRecipeBtn" class="bg-blue-600 text-white px-6 py-3 rounded-full font-semibold hover:bg-blue-700 transition shadow-lg">Compartir</button>
                            </div>
                        </div>
                        <div id="recipe-content-cooking" class="hidden">
                            <h4 class="text-2xl font-semibold mb-6 text-center">Modo Cocina</h4>
                            <div class="text-2xl md:text-3xl space-y-8 text-center">${recipe.steps.map((step, index) => `<div class="p-4 rounded-lg bg-amber-50 dark:bg-stone-900"><p class="font-bold text-amber-800 dark:text-amber-500 mb-2">Paso ${index + 1}</p><p>${step}</p></div>`).join('')}</div>
                            <div class="text-center mt-8"><button id="exitCookingModeBtn" class="bg-gray-600 text-white px-6 py-3 rounded-full font-semibold hover:bg-gray-700 transition shadow-lg">Salir del Modo Cocina</button></div>
                        </div>
                    </div>`;
                
                const servingsInput = document.getElementById('servings-input');
                const ingredientList = document.getElementById('ingredient-list');

                function renderIngredients(servings) {
                    ingredientList.innerHTML = recipe.ingredients.map(ing => {
                        let amount = ing.amount;
                        if(amount) {
                            amount = (amount / recipe.servings) * servings;
                            // Redondear a 1 decimal si es necesario
                            if (amount % 1 !== 0) {
                                amount = amount.toFixed(1);
                            }
                        }
                        return `<li>${amount ? amount : ''}${ing.unit ? ' ' + ing.unit : ''} ${ing.name}</li>`;
                    }).join('');
                }

                renderIngredients(recipe.servings);
                servingsInput.addEventListener('change', (e) => renderIngredients(e.target.value));

                dom.modal.style.display = 'flex';
                setTimeout(() => dom.modalContent.classList.add('scale-100'), 10);
                document.getElementById('closeModalBtn').addEventListener('click', closeModal);
                document.getElementById('cookingModeBtn').addEventListener('click', () => {
                    document.getElementById('recipe-content-normal').classList.add('hidden'); document.getElementById('recipe-content-cooking').classList.remove('hidden'); });
                document.getElementById('exitCookingModeBtn').addEventListener('click', () => {
                    document.getElementById('recipe-content-normal').classList.remove('hidden'); document.getElementById('recipe-content-cooking').classList.add('hidden'); });
                document.getElementById('printRecipeBtn').addEventListener('click', () => window.print());
                
                const shareBtn = document.getElementById('shareRecipeBtn');
                if (navigator.share) {
                    shareBtn.addEventListener('click', async () => {
                        try {
                            await navigator.share({
                                title: recipe.name,
                                text: `¡Mira esta receta de ${recipe.name}!`,
                                url: window.location.href,
                            });
                        } catch (err) {
                            console.error('Error al compartir:', err);
                        }
                    });
                } else {
                    shareBtn.style.display = 'none';
                }
            }
            
            function closeModal() {
                dom.modalContent.classList.remove('scale-100');
                setTimeout(() => { dom.modal.style.display = 'none'; dom.modalContent.innerHTML = ''; }, 300);
            }

            // --- MODO OSCURO ---
            function setupTheme() {
                if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                    document.documentElement.classList.add('dark');
                    dom.lightIcon.classList.remove('hidden');
                } else {
                    document.documentElement.classList.remove('dark');
                    dom.darkIcon.classList.remove('hidden');
                }
            }

            dom.themeToggle.addEventListener('click', function() {
                dom.darkIcon.classList.toggle('hidden');
                dom.lightIcon.classList.toggle('hidden');
                if (localStorage.getItem('color-theme')) {
                    if (localStorage.getItem('color-theme') === 'light') {
                        document.documentElement.classList.add('dark');
                        localStorage.setItem('color-theme', 'dark');
                    } else {
                        document.documentElement.classList.remove('dark');
                        localStorage.setItem('color-theme', 'light');
                    }
                } else {
                    if (document.documentElement.classList.contains('dark')) {
                        document.documentElement.classList.remove('dark');
                        localStorage.setItem('color-theme', 'light');
                    } else {
                        document.documentElement.classList.add('dark');
                        localStorage.setItem('color-theme', 'dark');
                    }
                }
            });

            setupTheme();

            // --- EVENT LISTENERS ---
            dom.search.addEventListener('input', applyFilters);

            dom.filterAllBtn.addEventListener('click', () => {
                currentFilter = 'all';
                dom.filterAllBtn.classList.add('active'); dom.filterFavBtn.classList.remove('active');
                applyFilters();
            });
            dom.filterFavBtn.addEventListener('click', () => {
                currentFilter = 'favorites';
                dom.filterFavBtn.classList.add('active'); dom.filterAllBtn.classList.remove('active');
                applyFilters();
            });
            
            dom.categoryFilters.addEventListener('click', (e) => {
                if (e.target.matches('.category-btn')) {
                    currentCategory = e.target.dataset.category;
                    document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
                    e.target.classList.add('active');
                    applyFilters();
                }
            });
            
            dom.modal.addEventListener('click', (event) => { if (event.target === dom.modal) closeModal(); });
            
            dom.filterAllBtn.classList.add('active');
        }

        // Ejecuta la app cuando el DOM esté listo
        runRecipeApp();
    </script>
</body>
</html>
