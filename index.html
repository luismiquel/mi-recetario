<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Recetario Delicioso</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Tu CSS: modo oscuro, dise√±o grid, modal, cooking mode */
    /*... (puedes reutilizar tu CSS original) ...*/
  </style>
</head>
<body class="dark:bg-stone-900 dark:text-stone-200">
  <div id="app" class="max-w-7xl mx-auto p-4">
    <header class="text-center mb-4">
      <h1 class="text-4xl font-bold text-amber-900 dark:text-amber-500">Recetario Delicioso</h1>
    </header>
    <div class="mb-4 flex items-center space-x-2">
      <input id="searchInput" class="border rounded-full p-2 flex-grow" placeholder="Buscar receta..." />
      <button id="filterFav" class="px-4 py-2 bg-amber-500 text-white rounded-full">Favoritas</button>
    </div>
    <div id="categoryFilters" class="flex space-x-2 mb-4 overflow-x-auto">
      <button data-category="all" class="px-3 py-1 bg-amber-100 rounded-full active">Todos</button>
      <button data-category="Aperitivo" class="px-3 py-1 bg-amber-100 rounded-full">Aperitivo</button>
      <button data-category="Primero" class="px-3 py-1 bg-amber-100 rounded-full">Primero</button>
      <button data-category="Segundo" class="px-3 py-1 bg-amber-100 rounded-full">Segundo</button>
      <button data-category="Postre" class="px-3 py-1 bg-amber-100 rounded-full">Postre</button>
    </div>
    <div id="recipeGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
    <div id="noResults" class="hidden text-center text-gray-500">No se encontraron recetas.</div>
  </div>

  <!-- Modal -->
  <div id="recipeModal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center p-4">
    <div id="modalContent" class="bg-white dark:bg-stone-800 rounded-xl shadow-xl max-w-xl w-full p-6"></div>
  </div>

  <!-- Cooking mode -->
  <div id="cookingMode" class="fixed inset-0 bg-white dark:bg-stone-900 hidden flex-col">
    <div class="flex-grow flex flex-col justify-center items-center">
      <p id="stepCounter" class="text-lg font-semibold text-amber-600"></p>
      <p id="stepText" class="text-3xl font-bold"></p>
    </div>
    <div class="p-4 bg-gray-100 dark:bg-stone-800 flex justify-between">
      <button id="prevStep" class="px-4 py-2 bg-gray-300 rounded">Anterior</button>
      <button id="repeatStep" class="px-4 py-2 bg-amber-500 text-white rounded">Repetir</button>
      <button id="nextStep" class="px-4 py-2 bg-gray-300 rounded">Siguiente</button>
    </div>
  </div>

  <script>
  // üßπ Eliminar duplicados
  const eliminarDuplicados = recetas => {
    const vistos = new Set();
    return recetas.filter(r => {
      const key = r.titulo.trim().toLowerCase();
      if (vistos.has(key)) return false;
      vistos.add(key);
      return true;
    });
  };

  // üì¶ Definici√≥n de todas las recetas (80)
  let allRecipes = [
    // (Incluye las 80 objetos como definiste: 20 de cada categor√≠a con imagen, ingredientes, pasos)
    // Para ejemplo corto pongo solo las primeras...
    { categoria:"Aperitivo", titulo:"Brochetas de aceituna y pimiento", imagen:"https://source.unsplash.com/800x600/?olive,skewer", ingredientes:["Aceitunas","Pimiento","Albahaca","Aceite","Pimienta"], pasos:["Ensarta...","Ali√±a...","Sirve."] },
    { categoria:"Aperitivo", titulo:"Garbanzos crujientes al horno", imagen:"https://source.unsplash.com/800x600/?roasted,chickpeas", ingredientes:["Garbanzos","Aceite","Piment√≥n","Comino","Sal"], pasos:["Mezcla...","Hornea...","Sirve."] },
    // ... resto de recetas ...
  ];
  allRecipes = eliminarDuplicados(allRecipes);

  // üåü Interface
  const dom = {
    grid: document.getElementById("recipeGrid"),
    sitchSearch: document.getElementById("searchInput"),
    filterFav: document.getElementById("filterFav"),
    catButtons: document.querySelectorAll("#categoryFilters button"),
    noResults: document.getElementById("noResults"),
    modal: document.getElementById("recipeModal"),
    modalContent: document.getElementById("modalContent"),
    cookingMode: document.getElementById("cookingMode"),
    stepCounter: document.getElementById("stepCounter"),
    stepText: document.getElementById("stepText"),
    prevStep: document.getElementById("prevStep"),
    repeatStep: document.getElementById("repeatStep"),
    nextStep: document.getElementById("nextStep"),
  };

  let userFavorites = [];
  let currentFilterFav = false;
  let currentCategory = "all";
  let currentSearch = "";
  let cookingSteps = [], currentStep = 0;

  function renderGrid() {
    dom.grid.innerHTML = "";
    const items = allRecipes.filter(r => {
      if (currentFilterFav && !userFavorites.includes(r.titulo)) return false;
      if (currentCategory !== "all" && r.categoria !== currentCategory) return false;
      if (currentSearch && !r.titulo.toLowerCase().includes(currentSearch) && !r.ingredientes.join(" ").toLowerCase().includes(currentSearch)) return false;
      return true;
    });
    if (items.length === 0) {
      dom.noResults.classList.remove("hidden");
      return;
    }
    dom.noResults.classList.add("hidden");
    items.forEach(r => {
      const div = document.createElement("div");
      div.className = "cursor-pointer";
      div.innerHTML = `
        <img src="${r.imagen}" class="w-full h-40 object-cover rounded">
        <div class="mt-2 font-semibold">${r.titulo}</div>`;
      div.onclick = () => openModal(r);
      dom.grid.appendChild(div);
    });
  }

  function openModal(r) {
    dom.modalContent.innerHTML = `
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-bold">${r.titulo}</h2>
        <button onclick="closeModal()">‚úñÔ∏è</button>
      </div>
      <img src="${r.imagen}" class="w-full h-48 object-cover rounded mb-4">
      <h3 class="font-semibold">Ingredientes:</h3>
      <ul>${r.ingredientes.map(i => `<li>- ${i}</li>`).join("")}</ul>
      <h3 class="mt-4 font-semibold">Pasos:</h3>
      <ol>${r.pasos.map(p => `<li>${p}</li>`).join("")}</ol>
      <div class="mt-4 flex space-x-2 justify-center">
        <button id="startCooking" class="px-4 py-2 bg-green-600 text-white rounded">Iniciar Cocina</button>
      </div>
    `;
    dom.modal.classList.remove("hidden");
    document.getElementById("startCooking").onclick = () => startCooking(r.pasos);
  }

  function closeModal() {
    dom.modal.classList.add("hidden");
    dom.modalContent.innerHTML = "";
  }

  function startCooking(steps) {
    cookingSteps = steps;
    currentStep = 0;
    dom.modal.classList.add("hidden");
    dom.cookingMode.classList.remove("hidden");
    updateCooking();
  }

  function updateCooking() {
    dom.stepCounter.textContent = `Paso ${currentStep + 1} de ${cookingSteps.length}`;
    dom.stepText.textContent = cookingSteps[currentStep];
    speak(cookingSteps[currentStep]);
  }

  dom.prevStep.onclick = () => {
    if (currentStep > 0) currentStep--, updateCooking();
  };
  dom.repeatStep.onclick = () => speak(cookingSteps[currentStep]);
  dom.nextStep.onclick = () => {
    if (currentStep + 1 < cookingSteps.length) {
      currentStep++;
      updateCooking();
    } else {
      speak("¬°Has terminado! Buen provecho.");
      dom.cookingMode.classList.add("hidden");
    }
  };

  function speak(text) {
    const ut = new SpeechSynthesisUtterance(text);
    ut.lang = "es-ES";
    speechSynthesis.cancel();
    speechSynthesis.speak(ut);
  }

  // üéØ Eventos
  dom.sitchSearch.addEventListener("input", e => {
    currentSearch = e.target.value.toLowerCase();
    renderGrid();
  });
  dom.filterFav.onclick = () => {
    currentFilterFav = !currentFilterFav;
    dom.filterFav.classList.toggle("bg-amber-500", currentFilterFav);
    renderGrid();
  };
  dom.catButtons.forEach(btn => {
    btn.onclick = () => {
      currentCategory = btn.dataset.category;
      dom.catButtons.forEach(b => b.classList.remove("bg-amber-500"));
      btn.classList.add("bg-amber-500");
      renderGrid();
    };
  });

  // üöÄ Initial render
  renderGrid();
  </script>
</body>
</html>
