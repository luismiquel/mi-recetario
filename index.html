<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Recetario Español – 160 recetas</title>
  <meta name="description" content="Recetario Español con 160 recetas. Búsqueda rápida, voz manos libres, modo guiado, alto contraste, letra grande y lista de la compra.">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <style>
    body { -webkit-tap-highlight-color: transparent; }
    .card { border-radius: 1rem; border: 1px solid rgba(120,113,108,.25); overflow: hidden; background:#fff }
    .dark .card { background:#1f2937; border-color:#374151 }
    img { width:100%; height:12rem; object-fit:cover; }
  </style>
</head>
<body class="bg-stone-50 dark:bg-stone-900 dark:text-stone-200">

  <header class="max-w-6xl mx-auto p-4 flex justify-between items-center">
    <div>
      <h1 class="text-2xl font-bold">Recetario Español – 160 recetas</h1>
      <p class="text-sm text-stone-600 dark:text-stone-400">Busca recetas · Voz manos libres · Lista de la compra</p>
    </div>
    <div class="flex gap-2">
      <button id="toggleTheme" class="px-3 py-1 rounded bg-stone-200 dark:bg-stone-700">🌙/☀️</button>
      <button id="openShopping" class="px-3 py-1 rounded bg-stone-200 dark:bg-stone-700">🧺</button>
    </div>
  </header>

  <main class="max-w-6xl mx-auto p-4">
    <section class="mb-4">
      <input id="search" type="search" placeholder="Buscar receta..."
        class="w-full px-3 py-2 rounded border border-stone-300 dark:border-stone-700 dark:bg-stone-800">
    </section>
    <section id="recipesGrid" class="grid grid-cols-2 sm:grid-cols-3 gap-4"></section>
    <p id="emptyState" class="hidden text-center text-stone-500 mt-6">No hay resultados.</p>
  </main>

  <!-- Drawer lista de la compra -->
  <aside id="shoppingDrawer" class="fixed top-0 right-0 w-80 max-w-full h-full bg-white dark:bg-stone-800 shadow-lg p-4 hidden">
    <div class="flex justify-between items-center mb-3">
      <h2 class="text-lg font-bold">Lista de la compra</h2>
      <button id="closeShopping">✕</button>
    </div>
    <ul id="shoppingList" class="space-y-2"></ul>
    <div class="mt-3 flex gap-2">
      <input id="newItem" class="flex-1 px-2 py-1 border rounded dark:bg-stone-700" placeholder="Añadir artículo">
      <button id="addItem" class="px-3 py-1 rounded bg-stone-200 dark:bg-stone-600">Añadir</button>
    </div>
  </aside>

  <!-- Incluimos el archivo de recetas -->
  <script src="recetas.js"></script>

  <script>
  // Generar URL de imagen (si no hay foto, placeholder)
  function imgURL(nombre) {
    return `https://placehold.co/800x500?text=${encodeURIComponent(nombre)}`;
  }

  // Render tarjetas
  function render(list) {
    const grid = document.getElementById("recipesGrid");
    const empty = document.getElementById("emptyState");
    if (!list.length) {
      grid.innerHTML = "";
      empty.classList.remove("hidden");
      return;
    }
    empty.classList.add("hidden");
    grid.innerHTML = list.map(r => `
      <article class="card">
        <img src="${imgURL(r.titulo)}" alt="Foto de ${r.titulo}">
        <div class="p-3">
          <h3 class="text-lg font-bold">${r.titulo}</h3>
          <p class="text-sm text-stone-500">${r.categoria}</p>
          <button class="mt-2 px-2 py-1 rounded bg-stone-200 dark:bg-stone-700" onclick="addMany(['${r.titulo}'])">➕ Añadir a la lista</button>
        </div>
      </article>`).join("");
  }

  // Buscar
  document.getElementById("search").oninput = e => {
    const q = e.target.value.toLowerCase();
    render(RECETAS.filter(r => r.titulo.toLowerCase().includes(q)));
  };

  // Lista de la compra
  let shopping = [];
  function renderList() {
    const ul = document.getElementById("shoppingList");
    ul.innerHTML = shopping.map((i,idx)=>`
      <li class="flex justify-between items-center">
        <span>${i}</span>
        <button onclick="removeItem(${idx})">🗑️</button>
      </li>`).join("");
  }
  function addItem(text) { if(text){ shopping.push(text); renderList(); } }
  function addMany(arr){ arr.forEach(addItem); openDrawer(); }
  function removeItem(i){ shopping.splice(i,1); renderList(); }
  document.getElementById("addItem").onclick = ()=>{ 
    const v=document.getElementById("newItem").value; 
    addItem(v); 
    document.getElementById("newItem").value="";
  };

  // Drawer
  const drawer=document.getElementById("shoppingDrawer");
  document.getElementById("openShopping").onclick=()=>drawer.classList.remove("hidden");
  document.getElementById("closeShopping").onclick=()=>drawer.classList.add("hidden");

  // Tema oscuro
  document.getElementById("toggleTheme").onclick=()=>{
    document.documentElement.classList.toggle("dark");
  };

  // Inicial
  render(RECETAS);
  </script>
</body>
</html>
